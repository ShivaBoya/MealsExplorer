<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Meal Explorer</title>
  <style>
    :root {
      --bg: #0f0f12;
      --panel: #14161b;
      --muted: #aeb6c2;
      --text: #eef2f6;
      --accent: #7c5cff;
      --accent-2: #3ecf8e;
      --danger: #ff6b6b;
      --card: #1a1d24;
      --border: #2a2f3a;
      --shadow: rgba(0,0,0,.35);
    }

    html, body {
      margin: 0;
      padding: 0;
      background: radial-gradient(1200px 800px at 80% -10%, #1a1730 0%, #0f0f12 60%);
      color: var(--text);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      min-height: 100dvh;
    }

    header {
      position: sticky;
      top: 0;
      z-index: 5;
      backdrop-filter: saturate(140%) blur(8px);
      background: linear-gradient(180deg, rgba(15,15,18,.9), rgba(15,15,18,.6));
      border-bottom: 1px solid var(--border);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px clamp(16px, 3vw, 28px);
    }

    .topbar {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .brand {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    .brand h1 {
      margin: 0;
      font-size: clamp(20px, 3vw, 28px);
      letter-spacing: .4px;
    }
    .brand .hint { color: var(--muted); font-size: 12px; }

    .controls {
      display: grid;
      grid-template-columns: 1fr 160px 160px;
      gap: 10px;
    }

    .control {
      position: relative;
    }

    input[type="search"], select {
      width: 100%;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: var(--panel);
      color: var(--text);
      outline: none;
      box-shadow: 0 10px 30px var(--shadow) inset, 0 2px 0 rgba(255,255,255,.03) inset;
    }
    input[type="search"]::placeholder { color: #9aa3af; }

    /* Suggestions dropdown */
    .suggestions {
      position: absolute;
      top: calc(100% + 8px);
      left: 0;
      right: 0;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      box-shadow: 0 12px 30px var(--shadow);
      overflow: hidden;
      display: none;
      max-height: 280px;
      overflow-y: auto;
      z-index: 10;
    }
    .suggestions.show { display: block; }
    .suggestions button {
      width: 100%;
      display: block;
      text-align: left;
      padding: 10px 12px;
      border: 0;
      background: transparent;
      color: var(--text);
      cursor: pointer;
      font-size: 14px;
    }
    .suggestions button:hover {
      background: rgba(124,92,255,.12);
    }

    main.container { padding-top: 18px; }

    /* Results grid */
    .meta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 10px;
      color: var(--muted);
      font-size: 14px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 14px;
    }

    @media (max-width: 980px) {
      .controls { grid-template-columns: 1fr 1fr; }
      .grid { grid-template-columns: repeat(2, minmax(0,1fr)); }
    }
    @media (max-width: 640px) {
      .controls { grid-template-columns: 1fr; }
      .grid { grid-template-columns: 1fr; }
    }

    .card {
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0));
      border: 1px solid var(--border);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 12px 24px var(--shadow);
      display: grid;
      grid-template-rows: 180px auto;
      min-height: 260px;
      transition: transform .2s ease, box-shadow .2s ease;
    }
    .card:hover { transform: translateY(-2px); box-shadow: 0 16px 30px var(--shadow); }

    .card .thumb { position: relative; background: #0c0d10; }
    .card img {
      width: 100%; height: 100%; object-fit: cover; display: block;
      filter: saturate(1.02);
    }
    .badge {
      position: absolute; bottom: 10px; left: 10px;
      background: rgba(20,22,27,.75);
      border: 1px solid var(--border);
      color: var(--accent-2);
      font-size: 12px; padding: 6px 10px; border-radius: 999px;
      backdrop-filter: blur(6px);
    }

    .body { padding: 12px 14px; }
    .title { font-size: 16px; margin: 0 0 6px; letter-spacing: .2px; }
    .sub { color: var(--muted); font-size: 13px; margin: 0; }

    /* Pagination */
    .pagination {
      margin: 20px 0 40px;
      display: flex; align-items: center; justify-content: center; gap: 8px;
      flex-wrap: wrap;
    }
    .pagination button {
      padding: 10px 14px; border-radius: 12px; border: 1px solid var(--border);
      background: var(--panel); color: var(--text);
      cursor: pointer; min-width: 44px;
    }
    .pagination button[disabled] { opacity: .5; cursor: not-allowed; }
    .page-info { color: var(--muted); font-size: 13px; margin-top: 6px; text-align: center; }

    /* Empty state */
    .empty {
      text-align: center; color: var(--muted);
      padding: 40px 20px; border: 1px dashed var(--border);
      border-radius: 16px; background: rgba(255,255,255,.02);
    }

    /* Loader (Uiverse-inspired) */
    .loader-wrap {
      position: fixed; inset: 0; display: none; place-items: center; z-index: 20;
      background: rgba(10,10,12,.45); backdrop-filter: blur(4px);
    }
    .loader-wrap.show { display: grid; }
    .loader {
      width: 88px; height: 88px; border-radius: 50%; position: relative; animation: spin 1.2s linear infinite;
      background: conic-gradient(from 0deg, var(--accent), transparent 60%);
      mask: radial-gradient(circle 34px, transparent 33px, #000 34px);
      -webkit-mask: radial-gradient(circle 34px, transparent 33px, #000 34px);
      box-shadow: 0 0 0 6px rgba(124,92,255,.15) inset;
    }
    .loader::after{
      content: ""; position: absolute; inset: 8px; border-radius: 50%;
      background: radial-gradient(80px 80px at 30% 30%, rgba(124,92,255,.35), rgba(255,255,255,.02));
      border: 1px solid var(--border);
    }
    @keyframes spin { to { transform: rotate(360deg);} }

    /* Tiny helpers */
    .pill { padding: 4px 8px; border-radius: 999px; background: rgba(255,255,255,.06); border: 1px solid var(--border); }
    .row { display: flex; align-items: center; gap: 8px; }
    a.link { color: var(--accent-2); text-decoration: none; }
  </style>
</head>
<body>
  <header>
    <div class="container topbar">
      <div class="brand">
        <h1>üçΩÔ∏è Meal Explorer</h1>
        <span class="hint">TheMealDB API ‚Äî Search ‚Ä¢ Filter ‚Ä¢ Sort ‚Ä¢ Paginate</span>
      </div>
      <div class="controls">
        <div class="control" style="grid-column: 1 / -1">
          <input id="search" type="search" placeholder="Search meals (debounced 500ms)‚Ä¶ e.g. 'chicken'" autocomplete="off" />
          <div id="suggestions" class="suggestions" role="listbox" aria-label="Meal suggestions"></div>
        </div>
        <div class="control">
          <select id="category">
            <option value="">All Categories</option>
          </select>
        </div>
        <div class="control">
          <select id="sort">
            <option value="name-asc">Sort: Name (A‚ÜíZ)</option>
            <option value="name-desc">Sort: Name (Z‚ÜíA)</option>
          </select>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="meta">
      <div class="row">
        <span id="count" class="pill">0 results</span>
        <span id="activeFilters" class="pill" style="display:none;"></span>
      </div>
      <div class="row"><a class="link" href="https://www.themealdb.com/api.php" target="_blank" rel="noreferrer">API Docs ‚Üó</a></div>
    </div>

    <section id="results" class="grid" aria-live="polite"></section>

    <div class="pagination" id="pagination"></div>
    <div class="page-info" id="pageInfo"></div>
  </main>

  <div class="loader-wrap" id="loader" aria-hidden="true"><div class="loader" role="progressbar" aria-label="Loading"></div></div>

  <script>
    const API = 'https://www.themealdb.com/api/json/v1/1/';

    // --- Utilities ---
    const debounce = (fn, wait = 300) => {
      let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), wait); };
    };
    const throttle = (fn, wait = 600) => {
      let inFlight = false; return (...args) => { if (inFlight) return; inFlight = true; try { fn(...args); } finally { setTimeout(() => inFlight = false, wait); } };
    };

    const els = {
      search: document.getElementById('search'),
      suggestions: document.getElementById('suggestions'),
      category: document.getElementById('category'),
      sort: document.getElementById('sort'),
      results: document.getElementById('results'),
      pagination: document.getElementById('pagination'),
      pageInfo: document.getElementById('pageInfo'),
      count: document.getElementById('count'),
      activeFilters: document.getElementById('activeFilters'),
      loader: document.getElementById('loader'),
    };

    const state = {
      searchTerm: '',
      category: '',
      sort: 'name-asc',
      page: 1,
      pageSize: 9,
      meals: [],
      total: 0,
    };

    const showLoader = (show = true) => {
      els.loader.classList.toggle('show', show);
      els.loader.setAttribute('aria-hidden', show ? 'false' : 'true');
    };

    // --- API calls ---
    async function fetchCategories() {
      const res = await fetch(API + 'list.php?c=list');
      const data = await res.json();
      return (data.categories || data.meals || []).map(c => c.strCategory);
    }

    async function fetchBySearch(term) {
      const res = await fetch(API + 'search.php?s=' + encodeURIComponent(term));
      const data = await res.json();
      return data.meals || [];
    }

    async function fetchByCategory(cat) {
      const res = await fetch(API + 'filter.php?c=' + encodeURIComponent(cat));
      const data = await res.json();
      // filter endpoint returns limited fields; annotate category for UI consistency
      const meals = (data.meals || []).map(m => ({
        idMeal: m.idMeal,
        strMeal: m.strMeal,
        strMealThumb: m.strMealThumb,
        strCategory: cat,
      }));
      return meals;
    }

    async function fetchLookup(id) {
      const res = await fetch(API + 'lookup.php?i=' + encodeURIComponent(id));
      const data = await res.json();
      return (data.meals && data.meals[0]) || null;
    }

    // --- Rendering ---
    function renderMeals() {
      const { page, pageSize, meals } = state;
      const start = (page - 1) * pageSize;
      const pageMeals = meals.slice(start, start + pageSize);

      els.results.innerHTML = '';
      if (!pageMeals.length) {
        els.results.innerHTML = `<div class="empty" style="grid-column: 1/-1">No meals found. Try a different search or category.</div>`;
      } else {
        for (const m of pageMeals) {
          const card = document.createElement('article');
          card.className = 'card';
          card.innerHTML = `
            <div class="thumb">
              <img src="${m.strMealThumb}" alt="${m.strMeal}" loading="lazy" />
              ${m.strCategory ? `<span class="badge">${m.strCategory}</span>` : ''}
            </div>
            <div class="body">
              <h3 class="title">${m.strMeal}</h3>
              ${m.strArea ? `<p class="sub">${m.strArea}</p>` : ''}
            </div>
          `;
          els.results.appendChild(card);
        }
      }

      els.count.textContent = `${state.total} result${state.total === 1 ? '' : 's'}`;
      const active = [];
      if (state.searchTerm) active.push(`search: "${state.searchTerm}"`);
      if (state.category) active.push(`category: ${state.category}`);
      els.activeFilters.style.display = active.length ? 'inline-block' : 'none';
      els.activeFilters.textContent = active.join(' ‚Ä¢ ');

      renderPagination();
    }

    function renderPagination() {
      const totalPages = Math.max(1, Math.ceil(state.total / state.pageSize));
      state.page = Math.min(state.page, totalPages);

      els.pagination.innerHTML = '';

      const makeBtn = (label, onClick, disabled = false) => {
        const b = document.createElement('button');
        b.textContent = label; b.disabled = disabled; b.addEventListener('click', throttle(onClick, 600));
        return b;
      };

      els.pagination.appendChild(makeBtn('‚ü® Prev', () => changePage(state.page - 1), state.page === 1));

      // show up to 5 page buttons centered around current
      const totalPagesToShow = 5;
      let start = Math.max(1, state.page - Math.floor(totalPagesToShow/2));
      let end = Math.min(totalPages, start + totalPagesToShow - 1);
      start = Math.max(1, end - totalPagesToShow + 1);

      for (let p = start; p <= end; p++) {
        const btn = makeBtn(String(p), () => changePage(p));
        if (p === state.page) btn.style.outline = `2px solid var(--accent)`;
        els.pagination.appendChild(btn);
      }

      els.pagination.appendChild(makeBtn('Next ‚ü©', () => changePage(state.page + 1), state.page === totalPages));
      els.pageInfo.textContent = `Page ${state.page} / ${totalPages}`;
    }

    function changePage(p) {
      const totalPages = Math.max(1, Math.ceil(state.total / state.pageSize));
      state.page = Math.min(Math.max(1, p), totalPages);
      renderMeals();
    }

    // --- Search + suggestions ---
    const handleSearchInput = debounce(async () => {
      const term = els.search.value.trim();
      state.searchTerm = term;
      state.page = 1;

      if (!term) {
        els.suggestions.classList.remove('show');
        await loadData();
        return;
      }

      // Fetch suggestions
      try {
        const list = await fetchBySearch(term);
        const names = list.map(m => ({ id: m.idMeal, name: m.strMeal })).slice(0, 8);
        els.suggestions.innerHTML = names.map(n => `<button role="option" data-id="${n.id}">${n.name}</button>`).join('');
        els.suggestions.classList.toggle('show', names.length > 0);
      } catch(e) { console.error(e); }

      await loadData();
    }, 500);

    els.suggestions.addEventListener('click', async (e) => {
      const btn = e.target.closest('button[data-id]');
      if (!btn) return;
      const id = btn.getAttribute('data-id');
      showLoader(true);
      try {
        const item = await fetchLookup(id);
        state.meals = item ? [item] : [];
        state.total = state.meals.length;
        state.page = 1;
        els.search.value = item ? item.strMeal : els.search.value;
        els.suggestions.classList.remove('show');
        renderMeals();
      } catch (e) { console.error(e); }
      finally { showLoader(false); }
    });

    // --- Orchestrate data fetching ---
    async function loadData() {
      showLoader(true);
      try {
        let list = [];
        if (state.searchTerm) {
          list = await fetchBySearch(state.searchTerm);
          // If category selected simultaneously, filter client-side (search has category info)
          if (state.category) {
            list = list.filter(m => m.strCategory === state.category);
          }
        } else if (state.category) {
          list = await fetchByCategory(state.category);
        } else {
          // default: show something pleasant (popular keyword)
          list = await fetchBySearch('chicken');
        }

        // sort
        list.sort((a,b) => {
          const A = (a.strMeal || '').toLowerCase();
          const B = (b.strMeal || '').toLowerCase();
          if (state.sort === 'name-asc') return A.localeCompare(B);
          if (state.sort === 'name-desc') return B.localeCompare(A);
          return 0;
        });

        state.meals = list;
        state.total = list.length;
        state.page = 1; // reset when data set changes
        renderMeals();
      } catch (e) {
        console.error(e);
        els.results.innerHTML = `<div class="empty" style="grid-column: 1/-1">Failed to load meals. Please try again.</div>`;
        els.pagination.innerHTML = '';
        els.pageInfo.textContent = '';
        els.count.textContent = '0 results';
      } finally {
        showLoader(false);
      }
    }

    // --- Wire up controls ---
    els.search.addEventListener('input', handleSearchInput);
    document.addEventListener('click', (e) => {
      if (!els.suggestions.contains(e.target) && e.target !== els.search) {
        els.suggestions.classList.remove('show');
      }
    });

    els.category.addEventListener('change', () => { state.category = els.category.value; state.page = 1; loadData(); });
    els.sort.addEventListener('change', () => { state.sort = els.sort.value; state.page = 1; renderMeals(); });

    // --- Init ---
    (async function init(){
      showLoader(true);
      try {
        // categories
        const cats = await fetchCategories();
        els.category.insertAdjacentHTML('beforeend', cats.map(c => `<option value="${c}">${c}</option>`).join(''));
      } catch(e){ console.error(e); }
      finally {
        await loadData();
      }
    })();
  </script>
</body>
</html>
<!-- <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Meal Explorer</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<header>
<div class="container topbar">
<div class="brand">
<h1>üçΩÔ∏è Meal Explorer</h1>
<span class="hint">TheMealDB API ‚Äî Search ‚Ä¢ Filter ‚Ä¢ Sort ‚Ä¢ Paginate</span>
</div>
<div class="controls">
<div class="control" style="grid-column: 1 / -1">
<input id="search" type="search" placeholder="Search meals (debounced 500ms)‚Ä¶ e.g. 'chicken'" autocomplete="off" />
<div id="suggestions" class="suggestions" role="listbox" aria-label="Meal suggestions"></div>
</div>
<div class="control">
<select id="category">
<option value="">All Categories</option>
</select>
</div>
<div class="control">
<select id="sort">
<option value="name-asc">Sort: Name (A‚ÜíZ)</option>
<option value="name-desc">Sort: Name (Z‚ÜíA)</option>
</select>
</div>
</div>
</div>
</header>


<main class="container">
<div class="meta">
<div class="row">
<span id="count" class="pill">0 results</span>
<span id="activeFilters" class="pill" style="display:none;"></span>
</div>
<div class="row"><a class="link" href="https://www.themealdb.com/api.php" target="_blank" rel="noreferrer">API Docs ‚Üó</a></div>
</div>


<section id="results" class="grid" aria-live="polite"></section>


<div class="pagination" id="pagination"></div>
<div class="page-info" id="pageInfo"></div>
</main>


<div class="loader-wrap" id="loader" aria-hidden="true"><div class="loader" role="progressbar" aria-label="Loading"></div></div>


<script src="script.js"></script>
</body>
</html> -->